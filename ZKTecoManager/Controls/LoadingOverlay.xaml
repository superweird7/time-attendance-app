<UserControl x:Class="ZKTecoManager.Controls.LoadingOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="300" d:DesignWidth="400"
             Visibility="Collapsed"
             IsHitTestVisible="True"
             Focusable="True">

    <!-- Block all mouse interactions -->
    <Grid Background="#80000000"
          IsHitTestVisible="True"
          MouseDown="Grid_MouseDown"
          MouseUp="Grid_MouseUp"
          PreviewMouseDown="Grid_PreviewMouseDown"
          PreviewMouseUp="Grid_PreviewMouseUp"
          PreviewKeyDown="Grid_PreviewKeyDown">
        <Border Background="White" CornerRadius="16" Padding="40,30"
                HorizontalAlignment="Center" VerticalAlignment="Center"
                MinWidth="280">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.2" ShadowDepth="4" BlurRadius="20"/>
            </Border.Effect>
            <StackPanel HorizontalAlignment="Center">
                <!-- Animated Loading Indicator -->
                <Grid Width="50" Height="50" Margin="0,0,0,20">
                    <Ellipse Width="50" Height="50" Stroke="#E5E7EB" StrokeThickness="4"/>
                    <Ellipse x:Name="SpinnerEllipse" Width="50" Height="50" StrokeThickness="4"
                             StrokeDashArray="2,2" RenderTransformOrigin="0.5,0.5">
                        <Ellipse.Stroke>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#667EEA" Offset="0"/>
                                <GradientStop Color="#764BA2" Offset="1"/>
                            </LinearGradientBrush>
                        </Ellipse.Stroke>
                        <Ellipse.RenderTransform>
                            <RotateTransform x:Name="SpinnerRotation" Angle="0"/>
                        </Ellipse.RenderTransform>
                    </Ellipse>
                </Grid>

                <!-- Loading Text -->
                <TextBlock x:Name="LoadingText" Text="Loading..."
                           FontSize="16" FontWeight="SemiBold" Foreground="#374151"
                           HorizontalAlignment="Center"/>

                <!-- Status Text -->
                <TextBlock x:Name="StatusText" Text=""
                           FontSize="13" Foreground="#6B7280"
                           HorizontalAlignment="Center" Margin="0,8,0,0"
                           TextWrapping="Wrap" TextAlignment="Center"/>

                <!-- Progress Bar (optional) -->
                <ProgressBar x:Name="ProgressBar" Width="200" Height="6"
                             Margin="0,15,0,0" Visibility="Collapsed"
                             Foreground="#667EEA" Background="#E5E7EB"/>
            </StackPanel>
        </Border>
    </Grid>

    <UserControl.Triggers>
        <EventTrigger RoutedEvent="UserControl.Loaded">
            <BeginStoryboard>
                <Storyboard RepeatBehavior="Forever">
                    <DoubleAnimation Storyboard.TargetName="SpinnerRotation"
                                     Storyboard.TargetProperty="Angle"
                                     From="0" To="360" Duration="0:0:1"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </UserControl.Triggers>
</UserControl>
