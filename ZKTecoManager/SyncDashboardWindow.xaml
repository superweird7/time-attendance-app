<Window x:Class="ZKTecoManager.SyncDashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:infra="clr-namespace:ZKTecoManager.Infrastructure"
        Title="Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Data Sync" Height="700" Width="1000"
        WindowStartupLocation="CenterOwner"
        Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="NoResize"
        FlowDirection="RightToLeft">

    <Window.Resources>
        <infra:BoolToColorConverter x:Key="BoolToColorConverter"/>
        <infra:BoolToStatusConverter x:Key="BoolToStatusConverter"/>
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="8" Background="#667EEA">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#5568D3"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#CCCCCC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="8" Background="#10B981">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#059669"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="8" Background="#EF4444">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#DC2626"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="8" Background="#6B7280">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4B5563"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WinBtn" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#40FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Border CornerRadius="15" Background="White">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.3" ShadowDepth="5" BlurRadius="20"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="70"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Border Grid.Row="0" CornerRadius="15,15,0,0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#667EEA" Offset="0"/>
                            <GradientStop Color="#764BA2" Offset="0.5"/>
                            <GradientStop Color="#F093FB" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>

                    <Grid>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="25,0" FlowDirection="LeftToRight">
                            <TextBlock Text="ðŸ”„" FontSize="24" Margin="0,0,10,0"/>
                            <TextBlock Text="Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" FontSize="20" FontWeight="Bold" Foreground="White"/>
                        </StackPanel>

                        <Button Content="âœ•" Style="{StaticResource WinBtn}" Click="CloseButton_Click" HorizontalAlignment="Left" Margin="15,0"/>
                    </Grid>
                </Border>

                <!-- Content -->
                <Grid Grid.Row="1" Margin="25">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Auto-Sync Settings -->
                    <Border Grid.Row="0" Background="#F0F9FF" CornerRadius="10" Padding="20" Margin="0,0,0,20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©" FontSize="16" FontWeight="Bold" Foreground="#1E40AF"/>
                                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                    <CheckBox x:Name="AutoSyncCheckBox" Content="ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©" FontSize="13" VerticalContentAlignment="Center" Checked="AutoSyncCheckBox_Changed" Unchecked="AutoSyncCheckBox_Changed"/>
                                    <TextBlock Text="ÙƒÙ„" Margin="20,0,5,0" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="IntervalComboBox" Width="80" SelectionChanged="IntervalComboBox_Changed">
                                        <ComboBoxItem Content="5 Ø¯Ù‚Ø§Ø¦Ù‚" Tag="5"/>
                                        <ComboBoxItem Content="10 Ø¯Ù‚Ø§Ø¦Ù‚" Tag="10"/>
                                        <ComboBoxItem Content="15 Ø¯Ù‚Ø§Ø¦Ù‚" Tag="15" IsSelected="True"/>
                                        <ComboBoxItem Content="30 Ø¯Ù‚Ø§Ø¦Ù‚" Tag="30"/>
                                        <ComboBoxItem Content="60 Ø¯Ù‚ÙŠÙ‚Ø©" Tag="60"/>
                                    </ComboBox>
                                    <CheckBox x:Name="IncrementalSyncCheckBox" Content="Ù…Ø²Ø§Ù…Ù†Ø© ØªØ²Ø§ÙŠØ¯ÙŠØ© (Ø£Ø³Ø±Ø¹)" FontSize="12" VerticalContentAlignment="Center" Margin="20,0,0,0" IsChecked="True" ToolTip="Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙ‚Ø· Ù…Ù†Ø° Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©"/>
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="ðŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©" Style="{StaticResource PrimaryButton}" Click="ViewSyncHistory_Click" Margin="0,0,10,0" ToolTip="Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©"/>
                                <Button Content="ðŸ“‚ Ù…Ù„ÙØ§Øª Ø§Ù„Ø³Ø¬Ù„" Style="{StaticResource SecondaryButton}" Click="OpenSyncLogs_Click" Margin="0,0,10,0"/>
                                <Button Content="âž• Ø¥Ø¶Ø§ÙØ© Ù…ÙˆÙ‚Ø¹" Style="{StaticResource PrimaryButton}" Click="AddLocation_Click" Margin="0,0,10,0"/>
                                <Button Content="ðŸ”„ Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ÙƒÙ„" Style="{StaticResource SuccessButton}" Click="SyncAll_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Locations Grid -->
                    <Border Grid.Row="1" Background="#F9FAFB" CornerRadius="10" Padding="10">
                        <DataGrid x:Name="LocationsGrid" AutoGenerateColumns="False" IsReadOnly="True"
                                  HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                  BorderThickness="0" Background="Transparent"
                                  RowHeight="50" CanUserAddRows="False"
                                  SelectionMode="Single" SelectionUnit="FullRow">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹" Binding="{Binding LocationName}" Width="150"/>
                                <DataGridTextColumn Header="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" Binding="{Binding Host}" Width="150"/>
                                <DataGridTextColumn Header="Ø§Ù„Ù…Ù†ÙØ°" Binding="{Binding Port}" Width="60"/>
                                <DataGridTextColumn Header="Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" Binding="{Binding DatabaseName}" Width="120"/>
                                <DataGridTemplateColumn Header="Ø§Ù„Ø­Ø§Ù„Ø©" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="12" Padding="8,4" HorizontalAlignment="Center"
                                                    Background="{Binding IsActive, Converter={StaticResource BoolToColorConverter}}">
                                                <TextBlock Text="{Binding IsActive, Converter={StaticResource BoolToStatusConverter}}"
                                                           Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Ø¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©" Binding="{Binding LastSyncTime, StringFormat=yyyy-MM-dd HH:mm}" Width="130"/>
                                <DataGridTextColumn Header="Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©" Binding="{Binding LastSyncStatus}" Width="100"/>
                                <DataGridTemplateColumn Header="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª" Width="200">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="ðŸ”„" ToolTip="Ù…Ø²Ø§Ù…Ù†Ø©" Width="35" Height="30" Margin="2"
                                                        Click="SyncLocation_Click" Tag="{Binding LocationId}"
                                                        Style="{StaticResource SuccessButton}"/>
                                                <Button Content="ðŸ”—" ToolTip="Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„" Width="35" Height="30" Margin="2"
                                                        Click="TestConnection_Click" Tag="{Binding LocationId}"
                                                        Style="{StaticResource PrimaryButton}"/>
                                                <Button Content="âœï¸" ToolTip="ØªØ¹Ø¯ÙŠÙ„" Width="35" Height="30" Margin="2"
                                                        Click="EditLocation_Click" Tag="{Binding LocationId}"
                                                        Style="{StaticResource PrimaryButton}"/>
                                                <Button Content="ðŸ—‘ï¸" ToolTip="Ø­Ø°Ù" Width="35" Height="30" Margin="2"
                                                        Click="DeleteLocation_Click" Tag="{Binding LocationId}"
                                                        Style="{StaticResource DangerButton}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Status Bar -->
                    <Border Grid.Row="2" Background="#F3F4F6" CornerRadius="8" Padding="15" Margin="0,15,0,0">
                        <Grid>
                            <TextBlock x:Name="StatusText" Text="Ø¬Ø§Ù‡Ø²" FontSize="13" Foreground="#6B7280" VerticalAlignment="Center"/>
                            <ProgressBar x:Name="SyncProgress" IsIndeterminate="True" Visibility="Collapsed"
                                         Width="200" Height="4" HorizontalAlignment="Left" Margin="100,0,0,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Border>

        <!-- Loading Overlay -->
        <Border x:Name="LoadingOverlay" Visibility="Collapsed" Background="#80000000" CornerRadius="15">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <Border Background="White" CornerRadius="15" Padding="40">
                    <StackPanel>
                        <TextBlock x:Name="LoadingText" Text="Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©..." FontSize="16" FontWeight="SemiBold"
                                   Foreground="#374151" HorizontalAlignment="Center"/>
                        <ProgressBar IsIndeterminate="True" Width="200" Height="4" Margin="0,15,0,0"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
    </Grid>
</Window>
